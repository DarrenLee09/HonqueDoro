<div class="dashboard-container">
  <!-- Welcome Section -->
  <div class="welcome-section">
    <h1><img src="https://goose.game/favicon.ico" alt="Goose Icon" style="height: 1.2em; vertical-align: middle; margin-right: 0.3em;">Welcome to HonqueDoro</h1>
    <p>Stay focused, be productive, and build better habits one session at a time.</p>
    <div class="quick-start">
      <button routerLink="/timer" class="start-session-btn">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M8 5v14l11-7z"/>
        </svg>
        Start Pomodoro Session
      </button>
    </div>
  </div>

  <!-- Today's Stats -->
  <div class="stats-grid">
    <div class="stat-card primary">
      <div class="stat-icon">🍅</div>
      <div class="stat-content">
        <div class="stat-number">{{ todayStats().completedSessions }}</div>
        <div class="stat-label">Sessions Today</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">⏱️</div>
      <div class="stat-content">
        <div class="stat-number">{{ todayStats().totalWorkTime }}m</div>
        <div class="stat-label">Focus Time</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">🔥</div>
      <div class="stat-content">
        <div class="stat-number">{{ todayStats().currentStreak }}</div>
        <div class="stat-label">Current Streak</div>
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-icon">🏆</div>
      <div class="stat-content">
        <div class="stat-number">{{ todayStats().bestStreak }}</div>
        <div class="stat-label">Best Streak</div>
      </div>
    </div>
  </div>

  <!-- Weekly Progress -->
  <div class="progress-section">
    <h2>📈 Weekly Progress</h2>
    
    <!-- Overall Progress Bar -->
    <div class="progress-card">
      <div class="progress-header">
        <span>{{ weeklyGoal().completed }} / {{ weeklyGoal().target }} sessions</span>
        <div class="progress-controls">
          <button class="goal-edit-btn" (click)="showGoalEditor = !showGoalEditor" title="Edit weekly goal">⚙️</button>
          <span class="progress-percentage">{{ weeklyProgressPercentage() | number:'1.0-0' }}%</span>
        </div>
      </div>
      
      <!-- Goal Editor -->
      <div class="goal-editor" *ngIf="showGoalEditor">
        <label for="weeklyTarget">Weekly Target:</label>
        <div class="goal-input-group">
          <input 
            type="number" 
            id="weeklyTarget" 
            #weeklyTargetInput
            [value]="weeklyGoal().target"
            min="1" 
            max="100"
            class="goal-input"
          >
          <button class="goal-save-btn" (click)="updateWeeklyGoal(+weeklyTargetInput.value); showGoalEditor = false">Save</button>
          <button class="goal-cancel-btn" (click)="showGoalEditor = false">Cancel</button>
        </div>
      </div>
      
      <div class="progress-bar">
        <div 
          class="progress-fill" 
          [style.width.%]="weeklyProgressPercentage()"
        ></div>
      </div>
      <div class="progress-message">
        <span *ngIf="weeklyProgressPercentage() >= 100" class="success">🎉 Goal achieved! Amazing work!</span>
        <span *ngIf="weeklyProgressPercentage() >= 80 && weeklyProgressPercentage() < 100" class="almost">🎯 Almost there! Keep going!</span>
        <span *ngIf="weeklyProgressPercentage() < 80" class="keep-going">💪 You've got this! Stay consistent!</span>
      </div>
      
      <!-- Reset Button -->
      <div class="progress-actions">
        <button class="reset-week-btn" (click)="resetWeeklyData()" title="Reset weekly data">
          🔄 Reset Week
        </button>
      </div>
    </div>

    <!-- Daily Breakdown Chart -->
    <div class="weekly-chart">
      <h3>Daily Breakdown</h3>
      <div class="chart-container">
        <div class="weekly-grid">
          <div 
            *ngFor="let day of weeklyData(); let i = index" 
            class="day-tile"
            [class.today]="isToday(i)"
            [class.active]="day.sessions > 0"
          >
            <!-- Day Name -->
            <div class="day-name">{{ day.day }}</div>
            
            <!-- Session Dots -->
            <div class="session-dots">
              <div 
                *ngFor="let dot of [].constructor(Math.min(day.sessions, 10)); let dotIndex = index"
                class="session-dot"
                [class.completed]="true"
              ></div>
              <div 
                *ngFor="let dot of [].constructor(Math.max(0, 10 - day.sessions)); let dotIndex = index"
                class="session-dot empty"
                (click)="addSessionToDay(i)"
              ></div>
              <div class="more-indicator" *ngIf="day.sessions > 10">
                +{{ day.sessions - 10 }}
              </div>
            </div>
            
            <!-- Session Count & Time -->
            <div class="day-stats">
              <div class="session-number">{{ day.sessions }}</div>
              <div class="focus-time" *ngIf="day.focusTime > 0">{{ formatFocusTime(day.focusTime) }}</div>
            </div>
            
            <!-- Quick Actions -->
            <div class="day-actions">
              <button class="action-btn add" (click)="addSessionToDay(i)" title="Add session">+</button>
              <button class="action-btn remove" (click)="removeSessionFromDay(i)" *ngIf="day.sessions > 0" title="Remove session">−</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Weekly Summary Stats -->
    <div class="weekly-summary">
      <div class="summary-stat">
        <div class="summary-number">{{ weeklyStats().totalSessions }}</div>
        <div class="summary-label">Total Sessions</div>
      </div>
      <div class="summary-stat">
        <div class="summary-number">{{ formatFocusTime(weeklyStats().totalFocusTime) }}</div>
        <div class="summary-label">Focus Time</div>
      </div>
      <div class="summary-stat">
        <div class="summary-number">{{ weeklyStats().activeDays }}/7</div>
        <div class="summary-label">Active Days</div>
      </div>
      <div class="summary-stat">
        <div class="summary-number">{{ weeklyStats().averageDaily }}</div>
        <div class="summary-label">Avg/Day</div>
      </div>
    </div>
  </div>

  <!-- Monthly Progress -->
  <div class="monthly-section">
    <h2>📅 Monthly Overview</h2>
    <div class="monthly-stats-grid">
      <div class="monthly-stat-card">
        <div class="monthly-icon">🎯</div>
        <div class="monthly-content">
          <div class="monthly-number">{{ monthlyStats().completionRate }}%</div>
          <div class="monthly-label">Goal Progress</div>
          <div class="monthly-detail">{{ monthlyGoal().completed }}/{{ monthlyGoal().target }}</div>
        </div>
      </div>
      
      <div class="monthly-stat-card">
        <div class="monthly-icon">📊</div>
        <div class="monthly-content">
          <div class="monthly-number">{{ monthlyStats().totalSessions }}</div>
          <div class="monthly-label">Total Sessions</div>
          <div class="monthly-detail">{{ monthlyStats().averageDaily }}/day avg</div>
        </div>
      </div>
      
      <div class="monthly-stat-card">
        <div class="monthly-icon">⏰</div>
        <div class="monthly-content">
          <div class="monthly-number">{{ formatFocusTime(monthlyStats().totalFocusTime) }}</div>
          <div class="monthly-label">Focus Time</div>
          <div class="monthly-detail">{{ monthlyStats().activeDays }}/30 active days</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Productivity Insights -->
  <div class="insights-section">
    <h2>🔍 Productivity Insights</h2>
    
    <!-- Best Time Analysis -->
    <div class="insight-cards">
      <div class="insight-card highlight">
        <div class="insight-header">
          <span class="insight-icon">⭐</span>
          <span class="insight-title">Peak Productivity</span>
        </div>
        <div class="insight-content">
          <div class="insight-value">{{ bestProductivityHour().hour }}</div>
          <div class="insight-desc">{{ bestProductivityHour().sessions }} sessions with {{ bestProductivityHour().efficiency }}% efficiency</div>
        </div>
      </div>
      
      <!-- Trend Analysis -->
      <div class="insight-card">
        <div class="insight-header">
          <span class="insight-icon">{{ getTrendIcon() }}</span>
          <span class="insight-title">Weekly Trend</span>
        </div>
        <div class="insight-content">
          <div class="insight-value" [style.color]="getTrendColor()">
            {{ productivityTrend().direction | titlecase }}
          </div>
          <div class="insight-desc" *ngIf="productivityTrend().change > 0">
            {{ productivityTrend().change }} sessions {{ productivityTrend().direction === 'up' ? 'increase' : 'decrease' }}
          </div>
          <div class="insight-desc" *ngIf="productivityTrend().change === 0">
            Consistent performance this week
          </div>
        </div>
      </div>
    </div>

    <!-- Hourly Productivity Chart -->
    <div class="hourly-chart">
      <h3>Hourly Productivity Pattern</h3>
      <div class="hourly-bars-container">
        <div 
          *ngFor="let hour of hourlyProductivity()" 
          class="hourly-bar-item"
        >
          <div 
            class="hourly-bar" 
            [style.height.%]="getHourlyBarHeight(hour.sessions)"
            [style.background]="'linear-gradient(180deg, rgba(102, 126, 234, ' + (hour.efficiency/100) + '), rgba(118, 75, 162, ' + (hour.efficiency/100) + '))'"
          >
            <div class="hourly-value" *ngIf="hour.sessions > 0">{{ hour.sessions }}</div>
          </div>
          <div class="hourly-label">{{ hour.hour }}</div>
          <div class="hourly-efficiency">{{ hour.efficiency }}%</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Activity -->
  <div class="activity-section">
    <h2>📝 Recent Sessions</h2>
    <div class="activity-list">
      <div 
        *ngFor="let session of recentSessions()" 
        class="activity-item"
        [class.work-session]="session.type === 'Work'"
        [class.break-session]="session.type === 'Break'"
      >
        <div class="activity-icon">
          <span *ngIf="session.type === 'Work'">🍅</span>
          <span *ngIf="session.type === 'Break'">☕</span>
        </div>
        <div class="activity-content">
          <div class="activity-title">{{ session.type }} Session</div>
          <div class="activity-duration">{{ session.duration }} minutes</div>
        </div>
        <div class="activity-time">{{ formatTimeAgo(session.completedAt) }}</div>
      </div>
    </div>
  </div>

  <!-- Goals & Achievements Section -->
  <div class="goals-section">
    <h2>🎯 Goals & Achievements</h2>
    
    <!-- Quick Goals Card -->
    <div class="goals-grid">
      <div class="goal-card">
        <div class="goal-header">
          <span class="goal-icon">🎯</span>
          <span class="goal-title">Weekly Goal</span>
        </div>
        <div class="goal-progress">
          <div class="goal-numbers">
            <span class="current">{{ weeklyGoal().completed }}</span>
            <span class="separator">/</span>
            <span class="target">{{ weeklyGoal().target }}</span>
          </div>
          <div class="goal-bar">
            <div class="goal-fill" [style.width.%]="weeklyProgressPercentage()"></div>
          </div>
        </div>
      </div>
      
      <div class="goal-card">
        <div class="goal-header">
          <span class="goal-icon">📅</span>
          <span class="goal-title">Monthly Goal</span>
        </div>
        <div class="goal-progress">
          <div class="goal-numbers">
            <span class="current">{{ monthlyGoal().completed }}</span>
            <span class="separator">/</span>
            <span class="target">{{ monthlyGoal().target }}</span>
          </div>
          <div class="goal-bar">
            <div class="goal-fill" [style.width.%]="(monthlyGoal().completed / monthlyGoal().target) * 100"></div>
          </div>
        </div>
      </div>
      
      <div class="achievement-card">
        <div class="achievement-header">
          <span class="achievement-icon">🏆</span>
          <span class="achievement-title">Recent Achievement</span>
        </div>
        <div class="achievement-content">
          <div class="achievement-badge">🔥</div>
          <div class="achievement-text">
            <div class="achievement-name">Weekly Warrior</div>
            <div class="achievement-desc">Completed 7 days in a row</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Focus Breakdown Section -->
  <div class="focus-breakdown-section">
    <h2>📊 Focus Breakdown</h2>
    
    <div class="breakdown-grid">
      <!-- Session Types -->
      <div class="breakdown-card">
        <h3>Session Types</h3>
        <div class="session-types">
          <div class="session-type work">
            <div class="type-indicator"></div>
            <span class="type-label">Work Sessions</span>
            <span class="type-count">{{ todayStats().completedSessions }}</span>
          </div>
          <div class="session-type break">
            <div class="type-indicator"></div>
            <span class="type-label">Break Sessions</span>
            <span class="type-count">{{ Math.floor(todayStats().completedSessions * 0.8) }}</span>
          </div>
        </div>
      </div>
      
      <!-- Time Distribution -->
      <div class="breakdown-card">
        <h3>Time Distribution</h3>
        <div class="time-distribution">
          <div class="time-slice focus" [style.width.%]="75">
            <span class="slice-label">Focus</span>
            <span class="slice-time">{{ todayStats().totalWorkTime }}m</span>
          </div>
          <div class="time-slice break" [style.width.%]="25">
            <span class="slice-label">Break</span>
            <span class="slice-time">{{ Math.floor(todayStats().totalWorkTime * 0.2) }}m</span>
          </div>
        </div>
      </div>
      
      <!-- Today's Progress Ring -->
      <div class="breakdown-card progress-ring-card">
        <h3>Today's Progress</h3>
        <div class="progress-ring-container">
          <div class="progress-ring">
            <svg class="progress-circle" width="120" height="120">
              <circle cx="60" cy="60" r="45" stroke="#e3f2fd" stroke-width="8" fill="none"></circle>
              <circle cx="60" cy="60" r="45" stroke="#667eea" stroke-width="8" fill="none" 
                      stroke-dasharray="283" 
                      [attr.stroke-dashoffset]="283 - (todayStats().completedSessions / 10) * 283"
                      class="progress-circle-fill"></circle>
            </svg>
            <div class="progress-text">
              <div class="progress-number">{{ todayStats().completedSessions }}</div>
              <div class="progress-label">sessions</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Stats Cards -->
  <div class="quick-stats-section">
    <h2>⚡ Quick Stats</h2>
    <div class="quick-stats-grid">
      <div class="quick-stat-card">
        <div class="quick-stat-icon">⏰</div>
        <div class="quick-stat-content">
          <div class="quick-stat-number">{{ formatFocusTime(todayStats().totalWorkTime) }}</div>
          <div class="quick-stat-label">Today's Focus</div>
        </div>
      </div>
      
      <div class="quick-stat-card">
        <div class="quick-stat-icon">📈</div>
        <div class="quick-stat-content">
          <div class="quick-stat-number">{{ weeklyStats().averageDaily }}</div>
          <div class="quick-stat-label">Daily Average</div>
        </div>
      </div>
      
      <div class="quick-stat-card">
        <div class="quick-stat-icon">🏃</div>
        <div class="quick-stat-content">
          <div class="quick-stat-number">{{ todayStats().currentStreak }}</div>
          <div class="quick-stat-label">Current Streak</div>
        </div>
      </div>
      
      <div class="quick-stat-card">
        <div class="quick-stat-icon">🎯</div>
        <div class="quick-stat-content">
          <div class="quick-stat-number">{{ weeklyStats().activeDays }}/7</div>
          <div class="quick-stat-label">Active Days</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="actions-section">
    <h2>⚡ Quick Actions</h2>
    <div class="action-grid">
      <button routerLink="/timer" class="action-card">
        <div class="action-icon">🍅</div>
        <div class="action-title">Start Timer</div>
        <div class="action-desc">Begin a new Pomodoro session</div>
      </button>

      <button routerLink="/statistics" class="action-card">
        <div class="action-icon">📊</div>
        <div class="action-title">View Stats</div>
        <div class="action-desc">Analyze your productivity</div>
      </button>

      <button routerLink="/settings" class="action-card">
        <div class="action-icon">⚙️</div>
        <div class="action-title">Settings</div>
        <div class="action-desc">Customize your experience</div>
      </button>
    </div>
  </div>
</div>
